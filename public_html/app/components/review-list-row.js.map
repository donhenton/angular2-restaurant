{"version":3,"sources":["../../src/app/components/review-list-row.ts"],"names":[],"mappings":"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","file":"review-list-row.js","sourcesContent":["import { Restaurant, ReviewDTO } from './../model/restaurant.interface';\nimport { Component, Input, EventEmitter, Output, ElementRef, Inject } from '@angular/core';\nimport { FormControl, FormGroup, Validators, FormBuilder } from '@angular/forms';\nimport 'rxjs/Rx';\nimport { InputValidators } from './../validators/input-validators';\n\n@Component({\n    selector: 'review-list-row',\n    template: `\n                    <form [formGroup]=\"reviewForm\">\n                    \n                    <td class=\"rating\">\n                            <input type=\"hidden\" formControlName=\"stampDate\">\n                            <span  *ngIf=\"!matchCurrent()\">{{review.starRating}}</span>\n                    \n                            <select  *ngIf=\"matchCurrent()\"  id=\"starRating\" formControlName=\"starRating\">\n                                    <option value=\"1\">1</option>\n                                    <option value=\"2\">2</option>\n                                    <option value=\"3\">3</option>\n                                    <option value=\"4\">4</option>\n                                    <option value=\"5\">5</option>\n                                    <option value=\"6\">6</option>\n                                    <option value=\"7\">7</option>\n                                    <option value=\"8\">8</option>\n                                    <option value=\"9\">9</option>\n                                    <option value=\"10\">10</option>\n                                    <option value=\"11\">11</option>\n                                    <option value=\"12\">12</option>\n                                    <option value=\"13\">13</option>\n                                    <option value=\"14\">14</option>\n                                    \n                            </select> \n                     <i class=\"fa fa-star-o\" aria-hidden=\"true\"></i>\n                    </td>\n                    <td class=\"listing\">\n                        <span *ngIf=\"!matchCurrent()\">{{review.reviewListing}}</span>\n                         <input  *ngIf=\"matchCurrent()\" formControlName=\"reviewListing\"   name=\"reviewListing\" id=\"reviewListing\" type=\"text\" /> \n                    </td>\n                    <td class=\"actionButton\">\n                         \n                            <button *ngIf=\"!matchCurrent()\"  (click)=\"onClick($event,'EDIT')\" class='btnEdit'>Edit</button>    \n                            <button *ngIf=\"matchCurrent()\"  [ngClass]=\"{inactive:this.reviewForm.invalid}\"     (click)=\"onClick($event,'SAVE')\" class='btnEdit'>Save</button> \n                       \n                    </td> \n                    \n                    <td class=\"actionButton\">\n                       \n                            <button *ngIf=\"!matchCurrent()\" (click)=\"onClick($event,'DELETE')\" class='btnDelete'>Delete</button>                       \n                            <button *ngIf=\"matchCurrent()\" (click)=\"onClick($event,'CANCEL')\" class='btnDelete'>Cancel</button>\n                        \n                    </td> \n                    </form>\n  `\n})\nexport class ReviewListRow {\n\n\n\n    @Input() review: ReviewDTO;\n    @Input() idx: number;\n    @Input() currentReview: ReviewDTO; //selected by the container if none, then this is null;\n\n    @Output('edit-event') editChange = new EventEmitter();\n    private domNode: HTMLElement = null;\n    private reviewForm: FormGroup;\n    private reviewBackup:ReviewDTO = null;\n    private sentInvalid:boolean = false;\n    constructor( @Inject(ElementRef) elementRef: ElementRef, fb: FormBuilder) {\n        this.domNode = elementRef.nativeElement;\n        this.reviewForm = fb.group({\n            reviewListing: ['', Validators.compose([\n                Validators.required,\n                InputValidators.cannotBeEmpty\n\n            ])],\n            stampDate: [new Date()],\n            id: [-1],\n            starRating: [1, Validators.required]\n        })\n\n\n\n\n\n\n\n    }\n    ngAfterViewInit() {\n        //this.reportDom.emit({\"dom\": this.domNode});\n\n    }\n\n    ngOnInit() {\n        this.reviewForm.setValue(this.review);\n        this.reviewBackup = {...this.review};\n        this.reviewForm.controls.reviewListing.valueChanges\n            .debounceTime(200)\n            .subscribe(this.onListingChange.bind(this));\n    }\n\n    onListingChange(ev) {\n        if (this.reviewForm.invalid && !this.sentInvalid)\n        {\n            //formObject.controls.username.errors\n            let message = \"Review Listing \"+this.reviewForm.controls['reviewListing'].errors.message;\n            this.editChange.emit({ \"type\": \"FORM_VALIDATION\", \"selectedReview\": this.review, idx: this.idx, invalid: this.reviewForm.invalid, message: message });\n            this.sentInvalid = true;\n        }\n        if (!this.reviewForm.invalid && this.sentInvalid)\n        {\n            this.sentInvalid = false;\n            this.editChange.emit({ \"type\": \"FORM_VALIDATION\", \"selectedReview\": this.review, idx: this.idx, invalid: this.reviewForm.invalid, message:\"\" });\n        }\n         \n    }\n\n    matchCurrent(): boolean {\n        let hit: boolean = false;\n        if (this.currentReview && this.currentReview.id === this.review.id) {\n            hit = true;\n        }\n\n        return hit;\n    }\n\n    public getDom() {\n        return this.domNode;\n    }\n\n\n    onClick(ev, type) {\n\n        if (type === \"CANCEL\") {\n            this.reviewForm.setValue(this.reviewBackup);\n            this.editChange.emit({ \"type\": type, \"selectedReview\": this.review, idx: this.idx });\n        }\n        if (type === \"DELETE\") {\n\n            this.editChange.emit({ \"type\": type, \"selectedReview\": this.review, idx: this.idx });\n        }\n        if (type == \"EDIT\") {\n\n\n            this.editChange.emit({ \"type\": type, \"selectedReview\": this.review, idx: this.idx });\n        }\n        if (type == \"SAVE\") {\n\n            if (this.reviewForm.valid) {\n                if (this.review.id > -1) {\n                    this.editChange.emit({ \"type\": type, \"selectedReview\": this.reviewForm.value, idx: this.idx });\n                }\n                else {\n                    this.editChange.emit({ \"type\": \"ADD\", \"selectedReview\": this.reviewForm.value, idx: this.idx });\n                }\n            }\n        }\n\n    }\n\n\n}"],"sourceRoot":"/src"}